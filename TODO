‚úÖ CONCLU√çDO (FEITO)
1. L√≥gica de "Devolver" / Finalizar (Backend & Frontend)

[x] Rota Backend: PUT /requisicoes/:id/devolver.

[x] Reposi√ß√£o de Stock: O sistema agora rep√µe automaticamente a quantidade na tabela Material ao devolver.

[x] Hist√≥ricos: Regista a entrada no Historico_Stock (sem erros de colunas) e cria registo na tabela Historico_Requisicao.

[x] Frontend: Bot√£o "FINALIZAR (DEVOLVIDO)" no Gestor e bot√£o "DEVOLVER" no Perfil do utilizador, ambos a comunicar com a nova rota.

2. L√≥gica de "Cancelar" Inteligente (Backend & Frontend)

[x] Rota Backend: PUT /requisicoes/:id/cancelar.

[x] Seguran√ßa de Stock: Se a requisi√ß√£o j√° estava aprovada (stock cativo), o sistema rep√µe o stock antes de cancelar. Se estava pendente, apenas cancela.

[x] Frontend: Bot√µes de "Cancelar" no Gestor e no Perfil atualizados para usar esta rota segura.

3. Hist√≥rico de Requisi√ß√µes (Auditoria)

[x] Backend: Endpoint GET /requisicoes/historico criado.

[x] Frontend (Gestor): Nova aba "HIST√ìRICO REQ." no Dashboard.

[x] Funcionalidade: Mostra quem fez a a√ß√£o (Respons√°vel), qual a a√ß√£o (Devolver/Cancelar) e detalhes.

[x] Pesquisa: Filtros de pesquisa a funcionar na nova aba.

4. Valida√ß√µes de Seguran√ßa

[x] Datas: Validar datas no passado / data fim anterior ao in√≠cio (O utilizador confirmou que o Frontend j√° bloqueia isto via popup).

5. Estrutura Base (Do "FEITO" anterior)

[x] Atualiza√ß√£o de todos os Controllers (id_estado_req, Estado_Requisicao, etc.).

[x] Filtros de estado no Frontend (incluindo "Cancelado").

[x] Coordenadas e Mapas (Google Maps link no detalhe).

üîµ N√ÉO FEITO / FUTURO (Prioridade Baixa ou Complexa)



